<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Theme Manager Examples</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé®</text></svg>" />
  
  <!-- Preload critical resources for better performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="/src/themes/base.css" as="style">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  
  <!-- Basecoat UI CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/basecoat-css@0.3.2/dist/basecoat.cdn.min.css">
  
  <!-- FOUC Prevention - visibility hidden method -->
  <style>
    /* Hide body until CSS is loaded to prevent flash */
    body {
      visibility: hidden;
      opacity: 0;
    }
    
    /* Basic theme variables for immediate application */
    :root {
      --background: oklch(1.0000 0 0);
      --foreground: oklch(0.1448 0 0);
      --font-sans: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
    }

    /* Landing page specific styles */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }
    .landing-container {
      text-align: center;
      max-width: 800px;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    h1 {
      font-size: 3rem;
      margin-bottom: 1rem;
      background: linear-gradient(45deg, #fff, #f0f0f0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .subtitle {
      font-size: 1.2rem;
      margin-bottom: 3rem;
      opacity: 0.9;
    }
    .examples {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
    }
    .example-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 2rem;
      text-decoration: none;
      color: inherit;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .example-card:hover {
      transform: translateY(-5px);
      background: rgba(255, 255, 255, 0.2);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
    }
    .example-title {
      font-size: 1.8rem;
      font-weight: bold;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    .example-desc {
      opacity: 0.8;
      line-height: 1.6;
    }
    .features {
      margin: 3rem 0;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    .feature {
      background: rgba(255, 255, 255, 0.1);
      padding: 1rem;
      border-radius: 10px;
      font-size: 0.9rem;
    }
    .github-link {
      display: inline-block;
      margin-top: 2rem;
      padding: 0.75rem 2rem;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      text-decoration: none;
      border-radius: 50px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }
    .github-link:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    /* Theme controls overlay */
    .theme-controls {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .theme-controls button {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }
    
    .theme-controls button:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }
    
    .theme-dropdown {
      position: relative;
    }
    
    .theme-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 8px;
      min-width: 150px;
      margin-top: 4px;
      display: none;
    }
    
    .theme-menu.show {
      display: block;
    }
    
    .theme-option {
      padding: 8px 12px;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s;
    }
    
    .theme-option:hover {
      background: rgba(255, 255, 255, 0.1);
    }
  </style>
  
  <!-- FOUC Prevention Script - Reveal when ready -->
  <script>
    (function() {
      // Detect theme for basic variables
      try {
        const savedTheme = localStorage.getItem('theme-current') || localStorage.getItem('theme') || 'default';
        const savedMode = localStorage.getItem('theme-mode') || 'auto';
        
        let resolvedMode = savedMode;
        if (savedMode === 'auto') {
          resolvedMode = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }
        
        // Apply basic theme variables for dark mode
        if (resolvedMode === 'dark') {
          document.documentElement.style.setProperty('--background', 'oklch(0.1448 0 0)');
          document.documentElement.style.setProperty('--foreground', 'oklch(0.9851 0 0)');
        }
        
        document.documentElement.setAttribute('data-theme', savedTheme);
        document.documentElement.setAttribute('data-mode', resolvedMode);
      } catch (error) {
        console.warn('Theme detection failed:', error);
      }
      
      // Reveal content when fully loaded
      function revealContent() {
        document.body.style.visibility = 'visible';
        document.body.style.opacity = '1';
        document.body.style.transition = 'opacity 0.2s ease-in-out';
        console.log('‚úÖ FOUC: Content revealed');
      }
      
      // Primary method: document ready state
      document.onreadystatechange = function() {
        if (document.readyState === 'complete') {
          revealContent();
        }
      };
      
      // Fallback 1: DOM content loaded
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(revealContent, 100);
      });
      
      // Fallback 2: Firefox-specific workaround
      if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1) {
        document.addEventListener('DOMContentLoaded', function() {
          setTimeout(revealContent, 50);
        });
      }
      
      // Fallback 3: Safety timeout to prevent forever hidden
      setTimeout(function() {
        if (document.body.style.visibility === 'hidden') {
          revealContent();
          console.warn('‚ö†Ô∏è FOUC: Timeout fallback triggered');
        }
      }, 3000);
    })();
  </script>
</head>
<body class="antialiased">
  <!-- Firefox FOUC workaround - dummy script -->
  <script>/* Firefox FOUC fix */</script>
  
  <!-- Theme Controls -->
  <div class="theme-controls">
    <div class="theme-dropdown">
      <button id="theme-button" title="Select theme">
        üé® Theme
      </button>
      <div id="theme-menu" class="theme-menu">
        <div class="theme-option" data-theme="default">Default</div>
        <div class="theme-option" data-theme="supabase">Supabase</div>
        <div class="theme-option" data-theme="tangerine">Tangerine</div>
      </div>
    </div>
    
    <button id="mode-toggle" title="Toggle light/dark mode">
      <span id="mode-icon">üåô</span>
    </button>
    
    <button id="font-selector-btn" title="Configure fonts">
      üî§
    </button>
  </div>

  <!-- Main landing content -->
  <div class="landing-container">
    <h1>üé® Theme Manager Examples</h1>
    <p class="subtitle">Professional theme management system with dynamic switching, font customization, and performance benchmarking</p>
    
    <div class="features">
      <div class="feature">‚ö° Professional Benchmarking</div>
      <div class="feature">üéØ Cache Performance Analysis</div>
      <div class="feature">üî§ Font Management</div>
      <div class="feature">üåì Dynamic Theme Switching</div>
      <div class="feature">üìä Performance Budgets</div>
      <div class="feature">üíæ Storage Optimization</div>
    </div>
    
    <div class="examples">
      <a href="./react/" class="example-card">
        <div class="example-title">
          ‚öõÔ∏è React Example
        </div>
        <p class="example-desc">
          Full-featured React application with shadcn/ui components, professional benchmark suite, and comprehensive theme management. Includes real-time performance monitoring and detailed analytics.
        </p>
      </a>
      
      <a href="./astro/" class="example-card">
        <div class="example-title">
          üöÄ Astro Example
        </div>
        <p class="example-desc">
          High-performance Astro application with Basecoat UI components, vanilla JavaScript implementation, and the same professional benchmarking capabilities as the React version.
        </p>
      </a>
    </div>
    
    <a href="https://github.com/mks2508/shadcn-basecoat-theming" class="github-link">
      üîó View on GitHub
    </a>
  </div>

  <!-- Simple theme management script -->
  <script type="module">
    // Basic theme management for landing page
    class LandingThemeManager {
      constructor() {
        this.currentTheme = localStorage.getItem('theme-current') || localStorage.getItem('theme') || 'default';
        this.currentMode = localStorage.getItem('theme-mode') || 'auto';
        this.themes = {
          default: { name: 'Default', cssFile: 'default' },
          supabase: { name: 'Supabase', cssFile: 'supabase' },
          tangerine: { name: 'Tangerine', cssFile: 'tangerine' }
        };
        this.init();
      }

      async init() {
        this.setupEventListeners();
        await this.loadTheme(this.currentTheme, this.currentMode);
      }

      setupEventListeners() {
        // Theme dropdown
        const themeButton = document.getElementById('theme-button');
        const themeMenu = document.getElementById('theme-menu');
        
        themeButton.addEventListener('click', () => {
          themeMenu.classList.toggle('show');
        });

        // Theme options
        document.querySelectorAll('.theme-option').forEach(option => {
          option.addEventListener('click', () => {
            const theme = option.dataset.theme;
            this.setTheme(theme, this.currentMode);
            themeMenu.classList.remove('show');
          });
        });

        // Mode toggle
        document.getElementById('mode-toggle').addEventListener('click', () => {
          this.toggleMode();
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
          if (!themeButton.contains(e.target) && !themeMenu.contains(e.target)) {
            themeMenu.classList.remove('show');
          }
        });

        // System preference change
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
          if (this.currentMode === 'auto') {
            this.loadTheme(this.currentTheme, this.currentMode);
          }
        });
      }

      async setTheme(theme, mode) {
        this.currentTheme = theme;
        this.currentMode = mode;
        localStorage.setItem('theme-current', theme);
        localStorage.setItem('theme-mode', mode);
        await this.loadTheme(theme, mode);
      }

      toggleMode() {
        const modes = ['light', 'dark', 'auto'];
        const currentIndex = modes.indexOf(this.currentMode);
        const nextIndex = (currentIndex + 1) % modes.length;
        this.currentMode = modes[nextIndex];
        localStorage.setItem('theme-mode', this.currentMode);
        this.updateModeIcon();
        this.loadTheme(this.currentTheme, this.currentMode);
      }

      updateModeIcon() {
        const modeIcon = document.getElementById('mode-icon');
        switch (this.currentMode) {
          case 'light':
            modeIcon.textContent = '‚òÄÔ∏è';
            break;
          case 'dark':
            modeIcon.textContent = 'üåô';
            break;
          case 'auto':
            modeIcon.textContent = 'üåó';
            break;
        }
      }

      async loadTheme(themeName, mode) {
        try {
          const theme = this.themes[themeName];
          if (!theme) return;

          let resolvedMode = mode;
          if (mode === 'auto') {
            resolvedMode = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
          }

          // Load CSS file
          const cssPath = `/src/themes/${theme.cssFile}-${resolvedMode}.css`;
          const response = await fetch(cssPath);
          const cssContent = await response.text();

          // Extract CSS variables
          const variables = this.extractCSSVariables(cssContent);
          
          // Apply variables to document
          Object.entries(variables).forEach(([property, value]) => {
            document.documentElement.style.setProperty(property, value);
          });

          // Update attributes
          document.documentElement.setAttribute('data-theme', themeName);
          document.documentElement.setAttribute('data-mode', resolvedMode);

          // Update button text
          document.getElementById('theme-button').textContent = `üé® ${theme.name}`;
          this.updateModeIcon();

          console.log(`‚úÖ Theme loaded: ${themeName} (${resolvedMode})`);
        } catch (error) {
          console.error('Failed to load theme:', error);
        }
      }

      extractCSSVariables(cssContent) {
        const variables = {};
        const rootMatch = cssContent.match(/:root\s*{([^}]+)}/);
        if (!rootMatch) return variables;

        const rootContent = rootMatch[1];
        const variableMatches = rootContent.match(/--[\\w-]+:\\s*[^;]+/g);
        
        if (variableMatches) {
          variableMatches.forEach(match => {
            const [property, value] = match.split(':').map(s => s.trim());
            if (property && value) {
              variables[property] = value;
            }
          });
        }
        
        return variables;
      }
    }

    // Initialize theme manager when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      new LandingThemeManager();
    });
  </script>
</body>
</html>