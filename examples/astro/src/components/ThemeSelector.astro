---
import Popover from './ui/Popover.astro';
import Button from './ui/Button.astro';
import ChevronDownIcon from './icons/ChevronDownIcon.astro';
import CheckIcon from './icons/CheckIcon.astro';
import SearchIcon from './icons/SearchIcon.astro';
import SettingsIcon from './icons/SettingsIcon.astro';
---

<div class="relative" data-theme-selector>
  <Popover 
    id="theme-selector-popover"
    triggerId="theme-button"
    triggerClass="inline-flex items-center justify-center rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 cursor-pointer"
    popoverClass="min-w-48 max-w-xs right-0 z-50"
  >
    <span slot="trigger" class="flex items-center gap-2">
      <span id="current-theme-label">Default</span>
      <div class="w-px h-4 bg-border"></div>
      <ChevronDownIcon />
    </span>

    <!-- Theme list content -->
    <header class="grid gap-1.5 pb-2 border-b">
      <h4 class="leading-none font-medium">Select Theme</h4>
      <p class="text-muted-foreground text-sm">Choose your preferred theme</p>
    </header>

    <div id="theme-list" class="grid gap-1">
      <!-- Theme options will be populated by JavaScript -->
      <button 
        type="button"
        class="theme-option relative flex w-full cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
        data-theme="default"
        data-theme-option
        role="menuitem"
      >
        <svg class="mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5H9a2 2 0 00-2 2v12a4 4 0 004 4h10a2 2 0 002-2V7a2 2 0 00-2-2z"></path>
        </svg>
        <span>Default</span>
        <CheckIcon class="ml-auto hidden" />
      </button>
    </div>

    <!-- Separator and actions -->
    <div class="h-px bg-border my-2"></div>
    <div class="flex gap-2">
      <Button 
        id="browse-more-themes"
        variant="ghost"
        class="flex-1 justify-start text-primary"
        role="menuitem"
      >
        <SearchIcon class="mr-2" />
        Browse More...
      </Button>
      <Button 
        id="theme-settings-btn"
        variant="ghost"
        class="px-2 text-muted-foreground hover:text-accent-foreground"
        role="menuitem"
      >
        <SettingsIcon />
      </Button>
    </div>
  </Popover>
</div>